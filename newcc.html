<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta name="description" content="a test space">
<meta name="author" content="fangliang">
<title>My blog</title>

<link href="resources/bootstrap331dist/css/bootstrap.css" rel="stylesheet">
<link href="resources/octicons/octicons.css" rel="stylesheet">
<link href="resources/foundation-icons/foundation-icons.css" rel="stylesheet">
<!-- icons -->
<link href="resources/css/wowblog.css" rel="stylesheet">
<!-- icons -->

<!-- make IE8 support HTML5 elements and media queries -->
<!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

<script src="resources/jquery/jquery-1.11.1.min.js"></script>
<script src="resources/bootstrap331dist/js/bootstrap.min.js"></script>

<script src="resources/js/githubapi.js"></script>
<!-- <script src="resources/js/wowblog.js"></script> -->

<!-- Local JavaScript -->



<style>
</style>

<script>
  var blogInfo = {};
</script>
</head>
<body>

  <div class="navbar navbar-default navbar-fixed-top" style="background-color: white; padding-top: 12px; height: 48px;">
    <div class="container">
      <div class="row">
        <div class="col-md-8">
        
          <a href="/index.html" target="_blank">
            <span class="glyphicon glyphicon-home navSpan" style="color: #0084B4"></span>
          </a>
          
          <span class="glyphicon glyphicon-list navSpan"></span>        
            
          <a href="/newblog.html" target="_blank">
            <span id="create" class="glyphicon glyphicon-plus navSpan"></span>
          </a>
          <span id="edit" class="glyphicon glyphicon-pencil navSpan" aria-hidden="true"></span>          
          
          <button id="cancel" type="button" class="btn btn-link " style="padding-bottom: 5px; margin-bottom: 8px">
            <span class="glyphicon glyphicon-remove"></span>
            <span>取消</span>
          </button>
          
          <button id="save" type="button" class="btn btn-success " style="padding-bottom: 5px; margin-bottom: 12px">
            <span class="glyphicon glyphicon-ok"></span>
            <span >&nbsp;保&nbsp;存&nbsp;</span>
          </button>
          <span id="info" style="color:#5BC0DE"></span>
          <button class="btn btn-success " style="padding-bottom: 5px; margin-bottom: 12px;visibility:hidden">&nbsp;</button>
          
          
          
        </div>

      

      </div>
    </div>
  </div>


   <div class="container">



    <div class="row">
      <div class="col-md-8">
        <div class="blog">

          <div id="blogTitle" style="font-size: 24px;"></div>
          <div class="mydivider"></div><!-- 分割线 -->
          
          <div id="blogContent" class="" style="padding-top: 2px;min-height:300px"></div>
        </div>
        </div>
        </div>
        </div>
        <!-- end  blog -->
        
        
    <div class="container">
    <div class="row">
      <div class="col-md-8">  
            
            
            <video id="myVideo" autoplay="autoplay"></video>
    <br />
    <input type="button" value="拍照" /><br />
    拍照結果：
    <div id="result">
    </div>
    <script type="text/javascript">
        $(document).ready(init);
  
        function init() {
            //为了便于使用这个接口，先做一下兼容性处理
            navigator.getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia;
            //Google Chrome用webkitGetUserMedia，Firefox用mozGetUserMedia
            navigator.getUserMedia({video:true}, success, error);  //显示影像
  
            //定义button点击后要做什麼
            $("input[type='button']").click(function () {
                shoot(); //执行拍照
            });
        }
        function success(stream) {
            $("#myVideo").attr("src", window.webkitURL.createObjectURL(stream));
            $("#myVideo").play();
        }
        function error(error) {
            alert(error.name || error);
        }
        //拍照
        function shoot() {
            var video = $("#myVideo")[0];
            var canvas = capture(video);
  
            $("#result").empty();
            $("#result").append(canvas); //呈现图像(拍照結果)
            var imgData = canvas.toDataURL("image/jpg");
            var base64String = imgData.substr(22); //取得base64字串
  
            //上传，储存图片
            /* $.ajax({
                url: "vod/avatar.php",
                type: "post",
                data: { data: base64String },
                async: true,
                success: function (htmlVal) {
                    alert("另存图片成功！");
                }, error: function (e) {
                    alert(e.responseText); //alert错误信息
                }
  
            }); */
            var path =  "/photo/"  + (new Date()).getTime() + ".jpg";
            saveFile(path, base64String, null, function (htmlVal) {
                alert("另存图片成功！");
            }, function (e) {
                alert(e.responseText)});
            
            
        }
  
        //从video元素抓取图像到canvas
        function capture(video) {
  
            var canvas = document.createElement('canvas'); //建立canvas js DOM元素
            canvas.width = video.videoWidth;
            canvas.height = video.videoHeight;
            var ctx = canvas.getContext('2d');
            ctx.drawImage(video, 0, 0);      
            return canvas;
        }
    </script>
            
            
      
       </div>
    </div>
    </div> 
        
  

</body>
</html>
