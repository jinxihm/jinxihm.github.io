<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta name="description" content="my place">
<meta name="author" content="fangliang">
<title>无魂</title>

<link href="resources/bootstrap331dist/css/bootstrap.css" rel="stylesheet">
<link href="resources/octicons/octicons.css" rel="stylesheet">
<link href="resources/foundation-icons/foundation-icons.css" rel="stylesheet">
<link href="resources/css/style.css" rel="stylesheet">

<script src="resources/jquery/jquery-1.11.1.min.js"></script>
<script src="resources/bootstrap331dist/js/bootstrap.min.js"></script>
<script src="resources/avos/av-mini.js"></script>
<script src="resources/js/script.js"></script>
<script>
	$(document).ready(function() {

		AV.initialize(appId, appKey);

		// 加载全部标签
		loadTag();

		// 加载前20篇文章
		loadPost(0, 20);

		$('#tagPanel').on({
			click : function() {
				loadPostOfTag($(this).text());
			}
		}, ".tag");

		$('#newPostPlaceholder').click(function() {
			$(this).css('display', 'none');
			$('#newPostBox').css('display', 'block').focus();
			$('#toolBar').css('display', 'block');
			$('#newPostItem').css('margin-bottom', '15px').removeClass('top-radius');
			$('#newPostItem').css('box-shadow', '1px 1px 40px rgba(0, 109, 109, 1)');
			$('.first-post').addClass('top-radius');
			$('#postList .post-item').css('opacity', '0.1');
		});

		$('#newPostBox').blur(function() {
			var text = $(this).text();
			var html = $(this).html();
			if (text.trim() === "" && html.indexOf('<img') < 0 && html.indexOf('<video') < 0) {
				$(this).css('display', 'none');
				$('#toolBar').css('display', 'none');
				$('#newPostPlaceholder').css('display', 'block');
				$('#newPostItem').css('margin-bottom', '0px').addClass('top-radius');
				$('#newPostItem').css('box-shadow', 'none');
				$('.first-post').css('border-top-left-radius', '0px').removeClass('top-radius');
				$('#postList .post-item').css('opacity', '1');
			}
		});

		$('#newPostBox').keyup(function(e) {
			if ($(this).text().trim() === "") {
				$('#createPostBtn').prop('disabled', true);
			} else {
				$('#createPostBtn').prop('disabled', false);
				if (e.ctrlKey && e.which == 13) {
					$('#createPostBtn').click();
				}
			}
		});

		$('#createPostBtn').click(function() {
			savePost($('#newPostBox').text(), $('#newPostBox').html());
		});

	});
</script>
</head>

<body>
  <div class="wrapper">
    <div class="dashboard-left">

      <div class="face-img">
        <img src="resources/img/t1.jpg">
      </div>

      <div class="face-text">
        <span>发现美</span>
        <span>·</span>
        <span>表达美</span>
      </div>

      <div id="tagPanel"></div>
      <!-- 模板 -->
      <span id="tagTempl" class="tag"></span>

    </div>
    <div class="content-main">
      <div id="newPostItem" class="post-item top-radius">
        <div id="newPostPlaceholder" class="box">有什么想法？</div>
        <div id="newPostBox" class="box" contentEditable=true spellcheck="false"></div>
        <div id="toolBar">
          <!-- <button type="button" class="btn btn-default" style="border:0px">拍照</button>
                  <button type="button" class="btn btn-default" style="border:0px">位置</button> -->
          <button id="createPostBtn" disabled type="button" class="btn btn-success">&nbsp;保&nbsp;存&nbsp;</button>
        </div>
      </div>

      <div id="postList"></div>
      <!-- 模板 -->
      <div class="post-item" id="postItemTempl">
        <div class="box"></div>
        <div class="post-foot"></div>
      </div>
    </div>
  <div class="dashboard-right"></div>
  </div>
</body>
</html>